{"version":3,"sources":["webpack:///Article.js","webpack:///./containers/Article.js"],"names":["webpackJsonp","788","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_wrapComponent","id","Component","_reactTransformCatchErrors2","mapStateToProps","state","currentRouter","login","profile","_state$article","article","currentTopicId","switchSupportInfo","isCommented","collectedTopics","isFetching","scrollT","__WEBPACK_IMPORTED_MODULE_0_redBoxBlackStyle__","__WEBPACK_IMPORTED_MODULE_0_redBoxBlackStyle___default","n","__WEBPACK_IMPORTED_MODULE_1_redbox_react__","__WEBPACK_IMPORTED_MODULE_1_redbox_react___default","__WEBPACK_IMPORTED_MODULE_2_react__","__WEBPACK_IMPORTED_MODULE_2_react___default","__WEBPACK_IMPORTED_MODULE_3_react_transform_catch_errors__","__WEBPACK_IMPORTED_MODULE_3_react_transform_catch_errors___default","__WEBPACK_IMPORTED_MODULE_4_react_redux__","__WEBPACK_IMPORTED_MODULE_5__actions__","__WEBPACK_IMPORTED_MODULE_6__components_common_Header_Header__","__WEBPACK_IMPORTED_MODULE_7__components_common_CircleLoading__","__WEBPACK_IMPORTED_MODULE_8__components_Article_Content_Content__","__WEBPACK_IMPORTED_MODULE_9__components_Article_Reply_Reply__","__WEBPACK_IMPORTED_MODULE_10__utils_getSize__","_extends","assign","target","i","arguments","length","source","key","hasOwnProperty","_createClass","defineProperties","props","descriptor","protoProps","staticProps","enterModule","_components","Article","displayName","filename","components","locals","imports","a","_Component","this","_this","getPrototypeOf","fadeIn","_props","dispatch","window","scrollTo","author","topicId","location","href","split","newProps","setState","_getSize","_props2","sessionStorage","masterProfile","loginName","loginname","JSON","stringify","_props3","parse","createElement","title","showBack","keys","fetchProfile","replies","__reactstandin__regenerateByEval","code","eval","propTypes","_default","reactHotLoader","default","leaveModule","register"],"mappings":"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","file":"Article.js","sourcesContent":["webpackJsonp([4],{\n\n/***/ 788:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* WEBPACK VAR INJECTION */(function(module) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_redBoxBlackStyle__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_redBoxBlackStyle___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_redBoxBlackStyle__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_redbox_react__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_redbox_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_redbox_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_react_transform_catch_errors__ = __webpack_require__(44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_react_transform_catch_errors___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_react_transform_catch_errors__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react_redux__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__actions__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__components_common_Header_Header__ = __webpack_require__(296);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__components_common_CircleLoading__ = __webpack_require__(299);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__components_Article_Content_Content__ = __webpack_require__(302);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_Article_Reply_Reply__ = __webpack_require__(303);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__utils_getSize__ = __webpack_require__(56);\n\n\n\n\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n(function () {\n  var enterModule = __webpack_require__(2).enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _components = {\n  Article: {\n    displayName: 'Article'\n  }\n};\n\nvar _reactTransformCatchErrors2 = __WEBPACK_IMPORTED_MODULE_3_react_transform_catch_errors___default()({\n  filename: 'F:/cnode/src/containers/Article.js',\n  components: _components,\n  locals: [],\n  imports: [__WEBPACK_IMPORTED_MODULE_2_react___default.a, __WEBPACK_IMPORTED_MODULE_1_redbox_react___default.a, __WEBPACK_IMPORTED_MODULE_0_redBoxBlackStyle___default.a]\n});\n\nfunction _wrapComponent(id) {\n  return function (Component) {\n    return _reactTransformCatchErrors2(Component, id);\n  };\n}\n\n\n\n\n\n\n\n\n\n\nvar Article = _wrapComponent('Article')(function (_Component) {\n  _inherits(Article, _Component);\n\n  function Article() {\n    _classCallCheck(this, Article);\n\n    var _this = _possibleConstructorReturn(this, (Article.__proto__ || Object.getPrototypeOf(Article)).call(this));\n\n    _this.state = {\n      fadeIn: true\n    };\n    return _this;\n  }\n\n  _createClass(Article, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      var _props = this.props,\n          scrollT = _props.scrollT,\n          dispatch = _props.dispatch,\n          article = _props.article,\n          isFetching = _props.isFetching;\n\n      if (scrollT) {\n        window.scrollTo(0, scrollT);\n      }\n      if (!article.author && !isFetching) {\n        var topicId = window.location.href.split('topic/')[1].split('?_')[0];\n        dispatch(Object(__WEBPACK_IMPORTED_MODULE_5__actions__[\"u\" /* fetchArticle */])(topicId));\n      }\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(newProps) {\n      var scrollT = newProps.scrollT;\n\n      window.scrollTo(0, scrollT);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.setState({\n        fadeIn: false\n      });\n\n      var _getSize = Object(__WEBPACK_IMPORTED_MODULE_10__utils_getSize__[\"a\" /* default */])(),\n          scrollT = _getSize.scrollT;\n\n      var _props2 = this.props,\n          currentTopicId = _props2.currentTopicId,\n          dispatch = _props2.dispatch,\n          profile = _props2.profile,\n          login = _props2.login;\n\n      dispatch(Object(__WEBPACK_IMPORTED_MODULE_5__actions__[\"C\" /* recordArticleScrollT */])(currentTopicId, scrollT));\n      if (!window.sessionStorage.masterProfile && login.loginName === profile.loginname) {\n        window.sessionStorage.masterProfile = JSON.stringify(profile);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          isFetching = _props3.isFetching,\n          article = _props3.article,\n          currentTopicId = _props3.currentTopicId,\n          login = _props3.login,\n          switchSupportInfo = _props3.switchSupportInfo,\n          isCommented = _props3.isCommented,\n          dispatch = _props3.dispatch,\n          collectedTopics = _props3.collectedTopics,\n          profile = _props3.profile;\n\n      if (login.loginName !== profile.loginname && window.sessionStorage.masterProfile) {\n        collectedTopics = JSON.parse(window.sessionStorage.masterProfile).collectedTopics;\n      }\n      return __WEBPACK_IMPORTED_MODULE_2_react___default.a.createElement(\n        'div',\n        null,\n        __WEBPACK_IMPORTED_MODULE_2_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_6__components_common_Header_Header__[\"a\" /* default */], { isFetching: isFetching, title: '\\u8BE6\\u60C5', showBack: true }),\n        Object.keys(article).length === 0 && __WEBPACK_IMPORTED_MODULE_2_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7__components_common_CircleLoading__[\"a\" /* default */], null),\n        Object.keys(article).length !== 0 && __WEBPACK_IMPORTED_MODULE_2_react___default.a.createElement(\n          'div',\n          null,\n          __WEBPACK_IMPORTED_MODULE_2_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_8__components_Article_Content_Content__[\"a\" /* default */], { article: article, dispatch: dispatch, fetchProfile: __WEBPACK_IMPORTED_MODULE_5__actions__[\"x\" /* fetchProfile */], login: login, collectedTopics: collectedTopics, profile: profile }),\n          __WEBPACK_IMPORTED_MODULE_2_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9__components_Article_Reply_Reply__[\"a\" /* default */], _extends({ replies: article.replies\n          }, { login: login, dispatch: dispatch, switchSupportInfo: switchSupportInfo, currentTopicId: currentTopicId, profile: profile, isCommented: isCommented }))\n        )\n      );\n    }\n  }, {\n    key: '__reactstandin__regenerateByEval',\n    value: function __reactstandin__regenerateByEval(key, code) {\n      this[key] = eval(code);\n    }\n  }]);\n\n  return Article;\n}(__WEBPACK_IMPORTED_MODULE_2_react__[\"Component\"]));\n\nArticle.propTypes = {\n  // currentTopicId: PropTypes.string.isRequired,\n  // article: PropTypes.object.isRequired,\n  // isFetching: PropTypes.bool.isRequired,\n  // dispatch: PropTypes.func.isRequired\n};\n\nfunction mapStateToProps(state) {\n  var currentRouter = state.currentRouter,\n      login = state.login,\n      profile = state.profile;\n  var _state$article = state.article,\n      currentTopicId = _state$article.currentTopicId,\n      switchSupportInfo = _state$article.switchSupportInfo,\n      isCommented = _state$article.isCommented;\n  var collectedTopics = profile.collectedTopics;\n\n  var isFetching = state.article[currentTopicId] ? state.article[currentTopicId].isFetching : false;\n  var scrollT = state.article[currentTopicId] ? state.article[currentTopicId].scrollT : '0';\n  var article = state.article[currentTopicId] && state.article[currentTopicId].article ? state.article[currentTopicId].article : {};\n  return { isFetching: isFetching, scrollT: scrollT, article: article, currentTopicId: currentTopicId, login: login, switchSupportInfo: switchSupportInfo, currentRouter: currentRouter, collectedTopics: collectedTopics, profile: profile, isCommented: isCommented };\n}\n\nvar _default = Object(__WEBPACK_IMPORTED_MODULE_4_react_redux__[\"b\" /* connect */])(mapStateToProps)(Article);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (_default);\n;\n\n(function () {\n  var reactHotLoader = __webpack_require__(2).default;\n\n  var leaveModule = __webpack_require__(2).leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(Article, 'Article', 'F:/cnode/src/containers/Article.js');\n  reactHotLoader.register(mapStateToProps, 'mapStateToProps', 'F:/cnode/src/containers/Article.js');\n  reactHotLoader.register(_default, 'default', 'F:/cnode/src/containers/Article.js');\n  leaveModule(module);\n})();\n\n;\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(13)(module)))\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// Article.js","import React, { Component, PropTypes } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { switchSupport, fetchComment, fetchArticle, recordArticleScrollT, fetchProfile } from '../actions'\r\nimport Header from '../components/common/Header/Header'\r\nimport CircleLoading from '../components/common/CircleLoading'\r\nimport Content from '../components/Article/Content/Content'\r\nimport Reply from '../components/Article/Reply/Reply'\r\nimport getSize from '../utils/getSize'\r\n\r\n\r\nclass Article extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      fadeIn: true\r\n    }\r\n  }\r\n  componentWillMount() {\r\n    const { scrollT, dispatch, article, isFetching } = this.props\r\n    if (scrollT) {\r\n      window.scrollTo(0, scrollT)\r\n    }\r\n    if (!article.author && !isFetching) {\r\n      const topicId = window.location.href.split('topic/')[1].split('?_')[0]\r\n      dispatch(fetchArticle(topicId))\r\n    }\r\n  }\r\n\r\n  componentWillReceiveProps(newProps) {\r\n    const { scrollT } = newProps;\r\n    window.scrollTo(0, scrollT)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.setState({\r\n      fadeIn: false\r\n    })\r\n    let { scrollT } = getSize()\r\n    const { currentTopicId, dispatch, profile, login } = this.props;\r\n    dispatch(recordArticleScrollT(currentTopicId, scrollT));\r\n    if (!window.sessionStorage.masterProfile && login.loginName === profile.loginname) {\r\n      window.sessionStorage.masterProfile = JSON.stringify(profile)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let { isFetching, article, currentTopicId, login, switchSupportInfo, isCommented, dispatch, collectedTopics, profile } = this.props;\r\n    if (login.loginName !== profile.loginname && window.sessionStorage.masterProfile) {\r\n      collectedTopics = JSON.parse(window.sessionStorage.masterProfile).collectedTopics\r\n    }\r\n    return (\r\n\r\n      <div>\r\n        <Header isFetching={isFetching} title='详情' showBack={true} />\r\n        {Object.keys(article).length === 0 && <CircleLoading />}\r\n        {Object.keys(article).length !== 0 &&\r\n          <div>\r\n            <Content {...({ article, dispatch, fetchProfile, login, collectedTopics, profile }) } />\r\n            <Reply replies={article.replies}\r\n              {...({ login, dispatch, switchSupportInfo, currentTopicId, profile, isCommented }) } />\r\n          </div>\r\n        }\r\n      </div>\r\n\r\n    )\r\n  }\r\n}\r\n\r\nArticle.propTypes = {\r\n  // currentTopicId: PropTypes.string.isRequired,\r\n  // article: PropTypes.object.isRequired,\r\n  // isFetching: PropTypes.bool.isRequired,\r\n  // dispatch: PropTypes.func.isRequired\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  const { currentRouter, login, profile } = state;\r\n  const { currentTopicId, switchSupportInfo, isCommented } = state.article;\r\n  const { collectedTopics } = profile\r\n  const isFetching = state.article[currentTopicId] ? state.article[currentTopicId].isFetching : false;\r\n  const scrollT = state.article[currentTopicId] ? state.article[currentTopicId].scrollT : '0';\r\n  const article = state.article[currentTopicId] && state.article[currentTopicId].article ? state.article[currentTopicId].article : {};\r\n  return { isFetching, scrollT, article, currentTopicId, login, switchSupportInfo, currentRouter, collectedTopics, profile, isCommented }\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(Article)\n\n\n// WEBPACK FOOTER //\n// ./containers/Article.js"],"sourceRoot":""}